<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>‚ö° Super Boost MM</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        /* GOOGLE FONT + RESET */
        :root{
            --primary: #6C63FF;
            --primary-dark: #524CFF;
            --accent: #00E5FF;
            --success: #00E676;
            --danger: #ff3d57;
            --card-bg: rgba(255,255,255,0.03);
            --glass-bg: rgba(255,255,255,0.04);
            --border: rgba(255,255,255,0.08);
            --muted: rgba(255,255,255,0.65);
            --kpay-color: #32cd32; /* Lime Green for KBZPay */
        }

        *{box-sizing:border-box; transition:.25s ease;}
        html,body{height:100%;margin:0;font-family:'Poppins',sans-serif;background:linear-gradient(180deg,#07080b,#0d0f15);color:#fff;-webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}

        /* HEADER */
        .user-info-bar{
            position:fixed;
            top:0;
            left:0;
            right:0;
            height:70px;
            display:flex;
            align-items:center;
            justify-content:space-between;
            padding:12px 22px;
            background:linear-gradient(180deg, rgba(10,10,15,0.65), rgba(10,10,15,0.55));
            border-bottom:1px solid var(--border);
            backdrop-filter: blur(8px);
            z-index:999;
            gap:12px;
        }
        .header-left .logo-text{font-weight:800;color:var(--accent);font-size:18px;letter-spacing:0.6px;}
        .header-right{display:flex;align-items:center;gap:12px;}
        .user-welcome{display:flex;align-items:center;gap:10px;}
        .user-avatar{
            width:44px;height:44px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;color:#fff;background:var(--primary);
            box-shadow:0 6px 18px rgba(108,99,255,0.18);
            font-size:16px;
        }
        .user-details{line-height:1;}
        .user-name{font-weight:600;}
        .user-email{font-size:12px;color:var(--muted);}

        .logout-btn{
            background:transparent;border:1px solid rgba(255,255,255,0.06);color:#fff;padding:8px 12px;border-radius:10px;cursor:pointer;font-weight:600;display:flex;align-items:center;gap:8px;
        }
        .logout-btn:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,0.4);}

        /* AUTH MODAL */
        .auth-modal{
            position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg, rgba(2,2,7,0.72), rgba(2,2,7,0.82));backdrop-filter: blur(6px);z-index:998;padding:20px;
        }
        .auth-container{
            width:100%;max-width:460px;background:var(--glass-bg);border:1px solid var(--border);border-radius:14px;padding:22px;
            box-shadow:0 12px 40px rgba(0,0,0,0.6);
        }
        .auth-header{text-align:center;margin-bottom:6px;}
        .logo-circle{
            width:68px;height:68px;border-radius:50%;margin:0 auto;display:flex;align-items:center;justify-content:center;font-size:28px;color:#fff;
            background:linear-gradient(135deg,var(--primary),var(--accent));box-shadow:0 8px 30px rgba(108,99,255,0.2);
        }
        .auth-header h2{margin:10px 0 6px;color:var(--accent);font-size:22px;}
        .auth-header p{margin:0;color:var(--muted);font-size:13px;}

        .auth-tabs{display:flex;margin-top:14px;border-bottom:1px solid rgba(255,255,255,0.03);}
        .auth-tab{flex:1;padding:10px 8px;background:transparent;border:none;color:#bfc7d6;cursor:pointer;font-weight:700;border-radius:8px;}
        .auth-tab.active{color:#fff;border-bottom:3px solid var(--accent);}

        .auth-form{display:none;padding-top:12px;}
        .auth-form.active{display:block;}
        .auth-error{display:none;background:rgba(255,77,77,0.08);color:#ffb3b3;padding:8px 10px;border-radius:8px;margin-bottom:8px;border:1px solid rgba(255,77,77,0.12);font-size:13px;}

        .form-group{margin-top:12px;}
        .form-label{display:block;font-weight:600;font-size:13px;margin-bottom:6px;color:#e6eefc;display:flex;gap:8px;align-items:center;}
        .form-input, .form-select{
            width:100%;padding:12px 14px;border-radius:10px;border:1px solid var(--border);background:transparent;color:#fff;font-size:14px;
            outline:none;
        }
        .form-input::placeholder{color:rgba(255,255,255,0.45);}
        .form-input:focus, .form-select:focus{box-shadow:0 6px 24px rgba(0,0,0,0.6);border-color:var(--accent);}

        .input-with-toggle{position:relative;display:flex;align-items:center;}
        .password-toggle{position:absolute;right:8px;background:transparent;border:none;color:rgba(255,255,255,0.6);padding:8px;border-radius:8px;cursor:pointer;}
        .password-toggle:hover{color:#fff;}

        .auth-btn{margin-top:14px;padding:12px;border-radius:10px;border:none;cursor:pointer;font-weight:800;display:flex;align-items:center;justify-content:center;gap:8px;background:linear-gradient(135deg,var(--primary),var(--primary-dark));box-shadow:0 10px 30px rgba(108,99,255,0.16);color:#fff;}

        .auth-footer{margin-top:12px;text-align:center;color:var(--muted);font-size:13px;}
        .auth-link{color:var(--accent);cursor:pointer;text-decoration:underline;}

        /* MAIN APP LAYOUT */
        .main-app{display:none;padding:90px 20px 40px;max-width:1200px;margin:0 auto;}
        .hero-section{padding:30px;text-align:center;border-radius:12px;background:linear-gradient(90deg, rgba(108,99,255,0.08), rgba(0,229,255,0.02));border:1px solid rgba(255,255,255,0.02);}
        .hero-content h1{margin:0;font-size:28px;color:var(--accent);letter-spacing:0.6px;}
        .hero-content p{margin-top:8px;color:var(--muted);font-size:14px;}

        .app-container{display:grid;grid-template-columns:1fr 360px;gap:20px;margin-top:18px;}
        .order-container{padding:18px;border-radius:12px;}
        .right-column{display:flex;flex-direction:column;gap:16px;}
        .section-title{display:flex;align-items:center;gap:10px;font-weight:800;color:var(--accent);}

        .form-divider{border:none;height:1px;background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.04));margin:12px 0;border-radius:4px;}

        .submit-btn{margin-top:12px;padding:12px;border-radius:10px;border:none;cursor:pointer;background:linear-gradient(135deg,var(--primary),var(--primary-dark));font-weight:800;color:#fff;width:100%;display:flex;align-items:center;justify-content:center;gap:8px;box-shadow:0 12px 30px rgba(108,99,255,0.12);}

        .submit-btn:disabled{opacity:0.55;cursor:not-allowed;transform:none;box-shadow:none;}

        .payment-info{padding:14px;border-radius:12px;}
        .payment-header{display:flex;align-items:center;gap:10px;margin-bottom:8px;color:var(--muted);}
        .payment-details{display:flex;flex-direction:column;}
        .payment-item{display:flex;align-items:center;gap:12px;padding:12px;border-radius:10px;border:1px solid var(--border);background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02)); margin-bottom: 8px;}
        .payment-item.kpay{border-color: var(--kpay-color); background: rgba(50, 205, 50, 0.1);} /* Kpay styling */
        .payment-item strong{display:block;font-weight:800;color:#fff;}
        .payment-item .item-text{flex: 1;}

        .payment-notice{margin-top:10px;padding:10px;border-radius:8px;background:rgba(255,255,255,0.02);font-size:13px;color:var(--muted);border:1px solid rgba(255,255,255,0.02);}

        .contact-info{padding:14px;border-radius:12px;}
        .contact-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px;}
        .contact-card{padding:10px;border-radius:10px;border:1px solid var(--border);display:flex;align-items:center;gap:10px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));}
        .contact-title{font-weight:700;}
        .contact-link{color:var(--accent);text-decoration:none;font-weight:700;}

        .app-footer{text-align:center;margin-top:22px;padding:12px;color:var(--muted);font-size:13px;border-top:1px solid rgba(255,255,255,0.02);}

        .response-message{display:none;padding:10px;border-radius:8px;margin-top:10px;font-weight:700;}
        .response-success{background:rgba(0,230,255,0.07);border:1px solid rgba(0,230,255,0.08);color:var(--accent);}
        .response-error{background:rgba(255,77,77,0.06);border:1px solid rgba(255,77,77,0.08);color:#ffb3b3;}

        /* Hidden helper */
        .hidden-field{display:none;}

        /* ENHANCED BEAUTIFUL SELECT UI */
        .form-select {
            width: 100%;
            padding: 14px 18px;
            border-radius: 12px;
            border: 1.5px solid var(--border);
            background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
            color: #fff;
            font-size: 15px;
            font-weight: 500;
            outline: none;
            cursor: pointer;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%236C63FF' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            background-size: 16px;
            padding-right: 46px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .form-select:hover {
            border-color: var(--primary);
            background: linear-gradient(180deg, rgba(108, 99, 255, 0.05), rgba(108, 99, 255, 0.02));
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(108, 99, 255, 0.15);
        }

        .form-select:focus {
            border-color: var(--accent);
            background: linear-gradient(180deg, rgba(0, 229, 255, 0.05), rgba(0, 229, 255, 0.02));
            box-shadow: 0 8px 24px rgba(0, 229, 255, 0.2);
            transform: translateY(-2px);
        }

        .form-select option {
            background: #0d0f15;
            color: #fff;
            padding: 12px;
            font-size: 14px;
        }

        .form-select option:checked {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            font-weight: 700;
        }

        .form-select option:hover {
            background: var(--primary-dark);
        }

        .form-select optgroup {
            background: #07080b;
            color: var(--accent);
            font-weight: 700;
            font-size: 13px;
            padding: 8px 12px;
            border-bottom: 1px solid var(--border);
        }

        .form-select optgroup option {
            padding-left: 20px;
            color: #e6eefc;
            background: #0d0f15;
        }

        /* ADMIN PANEL STYLES */
        .admin-login-btn {
            background: transparent;
            border: 1px solid var(--danger);
            color: var(--danger);
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 10px auto 0;
        }

        .admin-panel {
            position: fixed;
            top: 80px;
            right: 0;
            width: 80%;
            max-width: 800px;
            height: calc(100vh - 90px);
            background: linear-gradient(180deg, #0d0f15, #07080b);
            border-left: 1px solid var(--border);
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
            display: none;
            box-shadow: -10px 0 30px rgba(0, 0, 0, 0.5);
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .admin-header h2 {
            color: var(--accent);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-close-btn {
            background: var(--danger);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border);
            padding-bottom: 10px;
        }

        .admin-tab {
            background: transparent;
            border: none;
            color: var(--muted);
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
        }

        .admin-tab.active {
            background: rgba(108, 99, 255, 0.1);
            color: var(--primary);
            border-bottom: 2px solid var(--primary);
        }

        .admin-tab-content {
            display: none;
        }

        .admin-tab-content.active {
            display: block;
        }

        .user-list, .service-list, .order-list {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 15px;
            margin-top: 20px;
            max-height: 500px;
            overflow-y: auto;
        }

        .user-item, .service-item, .order-item {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .user-info h4 {
            margin: 0;
            color: var(--accent);
        }

        .user-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 5px;
            font-size: 12px;
            color: var(--muted);
        }

        .user-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 5px;
        }

        .action-btn {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--muted);
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            white-space: nowrap;
        }

        .action-btn.delete {
            border-color: var(--danger);
            color: var(--danger);
        }

        .action-btn.view {
            border-color: var(--primary);
            color: var(--primary);
        }

        .admin-search {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .admin-search-input {
            flex: 1;
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid var(--border);
            background: rgba(255, 255, 255, 0.05);
            color: white;
        }

        .admin-search-btn {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            cursor: pointer;
        }

        .service-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .service-name {
            color: var(--accent);
            font-weight: 600;
            margin: 0;
        }

        .service-category {
            background: rgba(108, 99, 255, 0.1);
            color: var(--primary);
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 12px;
        }

        .service-options {
            margin-top: 10px;
        }

        .option-item {
            background: rgba(255, 255, 255, 0.02);
            padding: 8px;
            border-radius: 6px;
            margin-bottom: 5px;
            font-size: 13px;
            border-left: 3px solid var(--primary);
        }

        .admin-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .admin-add-btn {
            background: var(--success);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .admin-modal-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1002;
            padding: 20px;
        }

        .admin-modal-content {
            background: #0d0f15;
            border-radius: 12px;
            width: 100%;
            max-width: 500px;
            border: 1px solid var(--border);
        }

        .admin-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid var(--border);
        }

        .admin-modal-body {
            padding: 20px;
            max-height: 70vh;
            overflow-y: auto;
        }

        .admin-modal-footer {
            padding: 20px;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .admin-save-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
        }

        .admin-cancel-btn {
            background: transparent;
            color: var(--muted);
            border: 1px solid var(--border);
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .order-service {
            color: var(--accent);
            font-weight: 600;
        }

        .order-time {
            color: var(--muted);
            font-size: 12px;
        }

        .order-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .order-detail-item {
            background: rgba(255, 255, 255, 0.02);
            padding: 8px;
            border-radius: 6px;
        }

        .order-detail-label {
            font-size: 12px;
            color: var(--muted);
            margin-bottom: 3px;
        }

        .order-detail-value {
            font-size: 14px;
            color: white;
            word-break: break-all;
        }

        .admin-filter-select {
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid var(--border);
            background: rgba(255, 255, 255, 0.05);
            color: white;
            width: 200px;
        }
        .admin-user-info-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .admin-user-info-bar h4{margin:0;}


        /* Responsive */
        @media (max-width:920px){
            .app-container{grid-template-columns:1fr; padding-bottom:30px;}
            .right-column{order:2;}
            .main-app{padding:100px 16px 30px;}
            .user-info-bar{padding:10px 16px;}
            .user-details{display:none;}
            .logout-btn{padding:6px 10px;}
            .admin-panel{width:100%; top:60px;}
        }

        @media (max-width: 768px) {
            .form-select {
                padding: 12px 16px;
                font-size: 14px;
                background-position: right 14px center;
            }
            .order-details{grid-template-columns: 1fr;}
            .user-actions{justify-content: space-between;}
            .admin-tabs{overflow-x: auto; white-space: nowrap;}
            .admin-tab{padding: 10px 12px;}
        }
    </style>
</head>
<body>

    <div id="userInfoBar" class="user-info-bar">
        <div class="header-left">
             <div class="logo-text">‚ö° SUPER BOOST MM</div>
        </div>
        <div class="header-right">
            <div class="user-welcome">
                <div class="user-avatar" id="userAvatar">U</div>
                <div class="user-details">
                    <div class="user-name" id="usernameDisplay"></div>
                    <div class="user-email" id="userEmail"></div>
                </div>
            </div>
            <button class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </div>
    </div>

    <div id="authModal" class="auth-modal">
        <div class="auth-container card-shadow">
            <div class="auth-header">
                <div class="logo-circle"><i class="fas fa-bolt"></i></div>
                <h2>SUPER BOOST MM</h2>
                <p>·Äù·Äî·Ä∫·ÄÜ·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äæ·ÄØ·Äô·Äª·Ä¨·Ä∏ ·Äô·Äæ·Ä¨·Äö·Ä∞·Äõ·Äî·Ä∫ Login ·Äù·ÄÑ·Ä∫·Äï·Ä´</p>
            </div>

            <div class="auth-tabs">
                <button class="auth-tab active" onclick="showAuthForm('login')">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
                <button class="auth-tab" onclick="showAuthForm('register')">
                    <i class="fas fa-user-plus"></i> Register
                </button>
            </div>

            <div id="loginForm" class="auth-form active">
                <div id="loginError" class="auth-error"></div>
                <form id="loginFormElement">
                    <div class="form-group">
                        <label class="form-label" for="loginUsername">
                            <i class="fas fa-user"></i> Username or Email
                        </label>
                        <input type="text" id="loginUsername" class="form-input" placeholder="·Äû·ÄÑ·Ä∑·Ä∫ username ·Äû·Ä≠·ÄØ·Ä∑·Äô·Äü·ÄØ·Äê·Ä∫ email" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="loginPassword">
                            <i class="fas fa-lock"></i> Password
                        </label>
                        <div class="input-with-toggle">
                            <input type="password" id="loginPassword" class="form-input" placeholder="Password" required>
                            <button type="button" class="password-toggle" onclick="togglePassword('loginPassword')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>

                    <button type="submit" class="auth-btn btn-primary">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                </form>

                <div class="auth-footer">
                    Account ·Äô·Äõ·Äæ·Ä≠·Äû·Ä±·Ä∏·Äï·Ä´·ÄÄ? <a class="auth-link" onclick="showAuthForm('register')">Register ·Äú·ÄØ·Äï·Ä∫·Äï·Ä´</a>
                </div>
            </div>

            <div id="registerForm" class="auth-form">
                <div id="registerError" class="auth-error"></div>
                <form id="registerFormElement">
                    <div class="form-group">
                        <label class="form-label" for="regUsername">
                            <i class="fas fa-user"></i> Username
                        </label>
                        <input type="text" id="regUsername" class="form-input" placeholder="·Äû·ÄÑ·Ä∑·Ä∫ username" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="regEmail">
                            <i class="fas fa-envelope"></i> Email
                        </label>
                        <input type="email" id="regEmail" class="form-input" placeholder="example@gmail.com" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="regPassword">
                            <i class="fas fa-lock"></i> Password
                        </label>
                        <div class="input-with-toggle">
                            <input type="password" id="regPassword" class="form-input" placeholder="·Ä°·Äî·Ää·Ä∫·Ä∏·ÄÜ·ÄØ·Ä∂·Ä∏ ·ÅÜ ·Äú·ÄØ·Ä∂·Ä∏" minlength="6" required>
                            <button type="button" class="password-toggle" onclick="togglePassword('regPassword')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="regConfirmPassword">
                            <i class="fas fa-lock"></i> Confirm Password
                        </label>
                        <div class="input-with-toggle">
                            <input type="password" id="regConfirmPassword" class="form-input" placeholder="Password ·Äï·Äº·Äî·Ä∫·Äõ·Ä≠·ÄØ·ÄÄ·Ä∫·Äï·Ä´" required>
                            <button type="button" class="password-toggle" onclick="togglePassword('regConfirmPassword')">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>

                    <button type="submit" class="auth-btn btn-primary">
                        <i class="fas fa-user-plus"></i> Register
                    </button>
                </form>

                <div class="auth-footer">
                    Account ·Äõ·Äæ·Ä≠·Äï·Äº·ÄÆ·Ä∏·Äû·Ä¨·Ä∏·Äú·Ä¨·Ä∏? <a class="auth-link" onclick="showAuthForm('login')">Login ·Äù·ÄÑ·Ä∫·Äï·Ä´</a>
                </div>
            </div>

            <div style="text-align: center; margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
                <button onclick="showAdminLogin()" class="admin-login-btn">
                    <i class="fas fa-user-shield"></i> Admin Login
                </button>
            </div>
        </div>
    </div>

    <div id="mainApp" class="main-app">

        <div class="hero-section">
            <div class="hero-content">
                <h1>‚ö° SUPER BOOST MM ‚ö°</h1>
                <p>
                    <i class="fas fa-check-circle"></i> ·Ä°·ÄÄ·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏·ÄÜ·ÄØ·Ä∂·Ä∏·Äà·Ä±·Ä∏·Äî·Äæ·ÄØ·Äî·Ä∫·Ä∏ <span class="separator">|</span>
                    <i class="fas fa-shield-alt"></i> ·ÄÖ·Ä≠·Äê·Äπ·Äê·Äõ<span class="separator">|</span>
                    <i class="fas fa-hourglass-half"></i> ·Ä°·Äô·Äº·Äî·Ä∫·ÄÜ·ÄØ·Ä∂·Ä∏·Äñ·Äº·Ää·Ä∑·Ä∫·Äû·ÄΩ·ÄÑ·Ä∫·Ä∏·Äô·Äæ·ÄØ
                </p>
            </div>
        </div>

        <div class="app-container">
            <div class="order-container card-shadow">
                <h2 class="section-title title-icon-primary">
                    <i class="fas fa-shopping-cart"></i> ·Äô·Äæ·Ä¨·Äö·Ä∞·Äô·Äæ·ÄØ ·ÄÖ·Äê·ÄÑ·Ä∫·Äï·Ä´
                </h2>

                <form id="orderForm">
                    <div class="form-group">
                        <label class="form-label" for="service">
                            <i class="fas fa-gamepad"></i> ·Äù·Äî·Ä∫·ÄÜ·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äæ·ÄØ ·Äõ·ÄΩ·Ä±·Ä∏·ÄÅ·Äª·Äö·Ä∫·Äï·Ä´
                        </label>
                        <select id="service" class="form-select" required>
                            <option value="" disabled selected>üïπÔ∏è ·Äù·Äî·Ä∫·ÄÜ·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äæ·ÄØ ·Äõ·ÄΩ·Ä±·Ä∏·ÄÅ·Äª·Äö·Ä∫·Äï·Ä´</option>
                            <optgroup label="üéÆ GAME TOP-UP">
                                <option value="MLBB Diamond">üíé Mobile Legends (Diamond)</option>
                                <option value="PUBG UC">üí∞ PUBG Mobile (UC)</option>
                                <option value="Free Fire Diamond">üî• Free Fire (Diamond)</option>
                                <option value="COD Points">üéØ Call of Duty Points</option>
                                <option value="Valorant Points">‚öîÔ∏è Valorant Points</option>
                                <option value="Genshin Impact Genesis">üå∏ Genshin Impact Genesis</option>
                            </optgroup>
                            <optgroup label="üì± SOCIAL MEDIA BOOST">
                                <option value="TikTok Followers">üë• TikTok Followers</option>
                                <option value="TikTok Views">üëÅÔ∏è TikTok Views</option>
                                <option value="TikTok Likes">‚ù§Ô∏è TikTok Likes</option>
                                <option value="Instagram Followers">üì∏ Instagram Followers</option>
                                <option value="Instagram Likes">üëç Instagram Likes</option>
                                <option value="Facebook Page Likes">üëç Facebook Page Likes</option>
                                <option value="YouTube Subscribers">üîî YouTube Subscribers</option>
                                <option value="Telegram Members">üë• Telegram Members</option>
                            </optgroup>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="userId">
                            <i class="fas fa-id-card"></i> <span id="userIdLabel">Player ID / Username</span>
                        </label>
                        <input type="text" id="userId" class="form-input" placeholder="·Äû·ÄÑ·Ä∑·Ä∫·Äõ·Ä≤·Ä∑ Player ID ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´" required>
                    </div>

                    <div class="form-group hidden-field" id="zoneIdGroup">
                        <label class="form-label" for="zoneId">
                            <i class="fas fa-map-marker-alt"></i> MLBB Zone ID
                        </label>
                        <input type="text" id="zoneId" class="form-input" placeholder="·Äû·ÄÑ·Ä∑·Ä∫·Äõ·Ä≤·Ä∑ Zone ID ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´ (·Ä•·Äï·Äô·Ä¨: 1234)">
                    </div>

                    <div class="form-group hidden-field" id="serverGroup">
                        <label class="form-label" for="server">
                            <i class="fas fa-server"></i> <span id="serverLabel">Server</span>
                        </label>
                        <select id="server" class="form-select">
                            <option value="" selected>Server ·Äõ·ÄΩ·Ä±·Ä∏·ÄÅ·Äª·Äö·Ä∫·Äï·Ä´</option>
                            <option value="Asia">Asia</option>
                            <option value="Europe">Europe</option>
                            <option value="America">America</option>
                            <option value="SEA">SEA</option>
                            <option value="Global">Global</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="amount">
                            <i class="fas fa-list-ol"></i> ·Äï·Äô·Ä¨·Äè / ·Ä°·Äõ·Ä±·Ä°·Äê·ÄΩ·ÄÄ·Ä∫
                        </label>
                        <select id="amount" class="form-select" required disabled>
                            <option value="" disabled selected>·Äï·Äô·Ä¨·Äè ·Äõ·ÄΩ·Ä±·Ä∏·ÄÅ·Äª·Äö·Ä∫·Äï·Ä´</option>
                        </select>
                    </div>

                    <hr class="form-divider">

                    <div class="form-group">
                        <label class="form-label" for="paymentId">
                            <i class="fas fa-receipt"></i> ·ÄÑ·ÄΩ·Ä±·Äú·ÄΩ·Äæ·Ä≤ ID/·Äñ·Ä±·Ä¨·ÄÄ·Ä∫·Äû·Ää·Ä∫·Ä°·Äô·Ää·Ä∫
                        </label>
                        <input type="text" id="paymentId" class="form-input" placeholder="·ÄÑ·ÄΩ·Ä±·Äú·ÄΩ·Äæ·Ä≤·Äï·Äº·Ä±·ÄÖ·Ä¨ ID ·Äû·Ä≠·ÄØ·Ä∑·Äô·Äü·ÄØ·Äê·Ä∫ ·Ä°·Äô·Ää·Ä∫" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="tgUsername">
                            <i class="fab fa-telegram"></i> Telegram Username (·ÄÜ·ÄÄ·Ä∫·Äû·ÄΩ·Äö·Ä∫·Äõ·Äî·Ä∫)
                        </label>
                        <input type="text" id="tgUsername" class="form-input" placeholder="·Ä•·Äï·Äô·Ä¨: @yourname">
                    </div>

                     <div class="form-group">
                        <label class="form-label" for="remarks">
                            <i class="fas fa-comment-alt"></i> ·Äê·ÄÑ·Ä∫·Äï·Äº·Äú·Ä≠·ÄØ·Äû·Ää·Ä∑·Ä∫ ·Ä°·ÄÄ·Äº·Ä±·Ä¨·ÄÑ·Ä∫·Ä∏·Ä°·Äõ·Ä¨·Äô·Äª·Ä¨·Ä∏
                        </label>
                        <input type="text" id="remarks" class="form-input" placeholder="·Ä•·Äï·Äô·Ä¨: Friend ·Ä°·Äê·ÄΩ·ÄÄ·Ä∫ ·Äù·Äö·Ä∫·Äï·Ä±·Ä∏·Äê·Ä¨·Äï·Ä´">
                    </div>

                    <button type="submit" id="submitBtn" class="submit-btn btn-primary" disabled>
                        <i class="fas fa-paper-plane"></i> ·Äô·Äæ·Ä¨·Äö·Ä∞·Äô·Äæ·ÄØ ·Ä°·Äê·Ää·Ä∫·Äï·Äº·ÄØ·Äõ·Äî·Ä∫
                    </button>

                    <div id="responseMessage" class="response-message"></div>
                </form>
            </div>

            <div class="right-column">
                <div class="payment-info card-shadow">
                    <div class="payment-header">
                        <i class="fas fa-money-bill-wave"></i>
                        <h2>üí∏ ·ÄÑ·ÄΩ·Ä±·Äï·Ä±·Ä∏·ÄÅ·Äª·Ä±·Äô·Äæ·ÄØ ·Äú·Äô·Ä∫·Ä∏·Ää·ÄΩ·Äæ·Äî·Ä∫ (Kpay Only)</h2>
                    </div>
                    <div class="payment-details">
                        <div class="payment-item kpay">
                            <i class="fas fa-mobile-alt" style="color: var(--kpay-color); font-size: 20px;"></i>
                            <div class="item-text">
                                <span style="color: var(--kpay-color);">KBZPay (Kpay)</span>
                                <strong>09970573598</strong>
                            </div>
                        </div>
                    </div>
                    <div class="payment-notice">
                        <i class="fas fa-exclamation-circle"></i>
                        ·ÄÑ·ÄΩ·Ä±·Äú·ÄΩ·Äæ·Ä≤·Äï·Äº·Ä±·ÄÖ·Ä¨ ID ·ÄÄ·Ä≠·ÄØ **·Äô·Äæ·Äî·Ä∫·ÄÄ·Äî·Ä∫·ÄÖ·ÄΩ·Ä¨** ·Äë·Ää·Ä∑·Ä∫·Äû·ÄΩ·ÄÑ·Ä∫·Ä∏·Äï·Ä±·Ä∏·Äï·Ä´·Åã ·Äù·Äî·Ä∫·ÄÜ·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äæ·ÄØ **·ÅÅ·ÅÖ ·Äô·Ä≠·Äî·ÄÖ·Ä∫·Äô·Äæ ·ÅÅ ·Äî·Ä¨·Äõ·ÄÆ** ·Ä°·Äê·ÄΩ·ÄÑ·Ä∫·Ä∏ ·Äï·Äº·ÄÆ·Ä∏·ÄÖ·ÄÆ·Ä∏·Äï·Ä´·Äô·Ää·Ä∫·Åã
                    </div>
                </div>

                <div class="contact-info card-shadow">
                    <h2 class="section-title title-icon-secondary">
                        <i class="fas fa-headset"></i> ·ÄÜ·ÄÄ·Ä∫·Äû·ÄΩ·Äö·Ä∫·Äõ·Äî·Ä∫
                    </h2>
                    <div class="contact-grid">
                        <div class="contact-card">
                            <i class="fab fa-telegram primary-color"></i>
                            <div class="contact-text">
                                <div class="contact-title">·Äù·Äî·Ä∫·ÄÜ·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äæ·ÄØ·Äï·Äº·Äø·Äî·Ä¨</div>
                                <a href="https://t.me/kyawthihahtun12345" target="_blank" class="contact-link">
                                    @kyawthihahtun12345
                                </a>
                            </div>
                        </div>
                        <div class="contact-card">
                            <i class="fas fa-money-check-alt secondary-color"></i>
                            <div class="contact-text">
                                <div class="contact-title">·ÄÑ·ÄΩ·Ä±·Äú·ÄΩ·Äæ·Ä≤·Äï·Äº·Äø·Äî·Ä¨</div>
                                <a href="https://t.me/kyawthihahtun12345" target="_blank" class="contact-link">
                                    @kyawthihahtun12345
                                </a>
                            </div>
                        </div>
                        <div class="contact-card contact-time" style="grid-column:span 2;">
                            <i class="fas fa-clock accent-color"></i>
                            <div class="contact-text">
                                <div class="contact-title">·Äù·Äî·Ä∫·ÄÜ·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äæ·ÄØ·Ä°·ÄÅ·Äª·Ä≠·Äî·Ä∫</div>
                                <div class="contact-value">·Äî·Ä±·Ä∑·ÄÖ·Äâ·Ä∫ (·Äô·Äî·ÄÄ·Ä∫ ·ÅÜ ·Äî·Ä¨·Äõ·ÄÆ·Äô·Äæ ·Ää ·ÅÅ·ÅÇ ·Äî·Ä¨·Äõ·ÄÆ·Äë·Ä≠)</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="app-footer">
            <p>¬© 2024 SUPER BOOST MM. All rights reserved. | Fast, Reliable, and Secure Service</p>
        </div>
    </div>

    <div id="adminPanel" class="admin-panel">
        <div class="admin-header">
            <h2><i class="fas fa-user-shield"></i> Admin Panel</h2>
            <button onclick="closeAdminPanel()" class="admin-close-btn">
                <i class="fas fa-times"></i> Close
            </button>
        </div>

        <div class="admin-tabs">
            <button class="admin-tab active" onclick="showAdminTab('users')">
                <i class="fas fa-users"></i> Users
            </button>
            <button class="admin-tab" onclick="showAdminTab('services')">
                <i class="fas fa-gamepad"></i> Services
            </button>
            <button class="admin-tab" onclick="showAdminTab('orders')">
                <i class="fas fa-shopping-cart"></i> Orders
            </button>
        </div>

        <div id="adminUsersTab" class="admin-tab-content active">
            <h3><i class="fas fa-users"></i> User Management</h3>
            <div class="admin-search">
                <input type="text" id="userSearch" placeholder="Search users..." class="admin-search-input">
                <button onclick="searchUsers()" class="admin-search-btn">
                    <i class="fas fa-search"></i>
                </button>
            </div>
            <div class="user-list" id="userList">
                </div>
        </div>

        <div id="adminServicesTab" class="admin-tab-content">
            <h3><i class="fas fa-gamepad"></i> Service Management</h3>
            <div class="admin-actions">
                <button onclick="showAddServiceModal()" class="admin-add-btn">
                    <i class="fas fa-plus"></i> Add New Service
                </button>
            </div>
            <div class="service-list" id="serviceList">
                </div>
        </div>

        <div id="adminOrdersTab" class="admin-tab-content">
            <h3><i class="fas fa-shopping-cart"></i> Order Management</h3>
            <div class="admin-search">
                <select id="orderFilter" class="admin-filter-select" onchange="filterOrders()">
                    <option value="all">All Orders</option>
                    <option value="today">Today</option>
                    <option value="week">This Week</option>
                    <option value="month">This Month</option>
                </select>
            </div>
            <div class="order-list" id="orderList">
                </div>
        </div>
    </div>

    <div id="addServiceModal" class="admin-modal-container" style="display:none;">
        <div class="admin-modal-content">
            <div class="admin-modal-header">
                <h3><i class="fas fa-plus"></i> Add New Service</h3>
                <button onclick="closeAddServiceModal()" class="admin-modal-close" style="background:transparent;border:none;color:var(--muted);cursor:pointer;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="admin-modal-body">
                <div class="form-group">
                    <label class="form-label">Service Name</label>
                    <input type="text" id="newServiceName" class="form-input" placeholder="e.g., MLBB Diamond">
                </div>
                <div class="form-group">
                    <label class="form-label">Service Category</label>
                    <select id="newServiceCategory" class="form-select">
                        <option value="game">Game Top-up</option>
                        <option value="social">Social Media Boost</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Options (JSON Format)</label>
                    <textarea id="newServiceOptions" class="form-input" rows="5" placeholder='[{"text": "üíé 5 Diamonds (250 MMK)", "value": "5 Diamonds (250 MMK)"}]'></textarea>
                    <small style="color:var(--muted);">Enter options in JSON array format</small>
                </div>
            </div>
            <div class="admin-modal-footer">
                <button onclick="closeAddServiceModal()" class="admin-cancel-btn">Cancel</button>
                <button onclick="saveNewService()" class="admin-save-btn">Save Service</button>
            </div>
        </div>
    </div>

    <script>
        // API Configuration (For mock purposes)
        const API_CONFIG = {
            baseUrl: 'https://api.example.com',
            endpoints: {
                users: '/users',
                services: '/services',
                orders: '/orders'
            },
            headers: {
                'Content-Type': 'application/json',
                'Authorization': 'Bearer your-api-key-here'
            }
        };

        let currentUser = null;
        const USERS_KEY = 'superboost_users_v4';
        const CURRENT_USER_KEY = 'superboost_current_user_v4';
        const SERVICES_KEY = 'superboost_services_v4';
        const ORDERS_KEY = 'superboost_orders_v4';

        // Admin credentials
        const ADMIN_USERNAME = "admin";
        const ADMIN_PASSWORD = "admin123";

        document.addEventListener('DOMContentLoaded', function() {
            checkLoginStatus();
            initPasswordToggles();
            initOrderForm();
            initializeServices();
        });

        // Initialization functions
        function checkLoginStatus() {
            const savedUser = localStorage.getItem(CURRENT_USER_KEY);
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    showMainApp();
                } catch (e) {
                    console.error('Error parsing user data:', e);
                    showAuthModal();
                }
            } else {
                showAuthModal();
            }
        }

        function showAuthModal() {
            document.getElementById('authModal').style.display = 'flex';
            document.getElementById('mainApp').style.display = 'none';
            document.getElementById('userInfoBar').style.display = 'none';
            document.body.style.paddingTop = '0';
        }

        function showMainApp() {
            document.getElementById('authModal').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            document.getElementById('userInfoBar').style.display = 'flex';
            document.body.style.paddingTop = '80px';

            document.getElementById('usernameDisplay').textContent = currentUser.username;
            document.getElementById('userEmail').textContent = currentUser.email;
            document.getElementById('userAvatar').textContent = currentUser.username.charAt(0).toUpperCase();

            const colors = ['#00bcd4', '#f50057', '#673ab7', '#ff9100', '#00e676'];
            const colorIndex = currentUser.username.length % colors.length;
            document.getElementById('userAvatar').style.background = colors[colorIndex];
        }

        function showAuthForm(formType) {
            document.querySelectorAll('.auth-tab').forEach(tab => tab.classList.remove('active'));
            if (formType === 'login') {
                document.querySelector('.auth-tab:nth-child(1)').classList.add('active');
                document.getElementById('loginForm').classList.add('active');
                document.getElementById('registerForm').classList.remove('active');
            } else {
                document.querySelector('.auth-tab:nth-child(2)').classList.add('active');
                document.getElementById('registerForm').classList.add('active');
                document.getElementById('loginForm').classList.remove('active');
            }

            clearAuthErrors();
        }

        function clearAuthErrors() {
            const e1 = document.getElementById('loginError');
            const e2 = document.getElementById('registerError');
            if (e1){ e1.style.display = 'none'; }
            if (e2){ e2.style.display = 'none'; }
        }

        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            const toggleButton = input.parentElement.querySelector('.password-toggle');
            const icon = toggleButton.querySelector('i');

            if (input.type === 'password') {
                input.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                input.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }

        function initPasswordToggles() {
            // buttons already use onclick in HTML
        }

        // LOGIN
        document.getElementById('loginFormElement').addEventListener('submit', function(e) {
            e.preventDefault();

            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value.trim();
            const errorDiv = document.getElementById('loginError');
            const loginBtn = document.querySelector('#loginFormElement .auth-btn');

            if (!username || !password) {
                showError(errorDiv, 'Username/Email ·Äî·Äæ·ÄÑ·Ä∑·Ä∫ Password ·Äú·Ä≠·ÄØ·Ä°·Äï·Ä∫·Äï·Ä´·Äû·Ää·Ä∫·Åã');
                return;
            }

            const users = JSON.parse(localStorage.getItem(USERS_KEY) || '[]');
            const user = users.find(u =>
                (u.username === username || u.email === username) &&
                u.password === password
            );

            if (user) {
                currentUser = {
                    id: user.id,
                    username: user.username,
                    email: user.email
                };

                localStorage.setItem(CURRENT_USER_KEY, JSON.stringify(currentUser));
                const originalText = loginBtn.innerHTML;
                loginBtn.innerHTML = '<i class="fas fa-check"></i> Login Successful!';
                loginBtn.style.background = 'var(--success)';

                setTimeout(() => {
                    loginBtn.innerHTML = originalText;
                    loginBtn.style.background = '';
                    showMainApp();
                }, 900);
            } else {
                showError(errorDiv, 'Username/Email ·Äû·Ä≠·ÄØ·Ä∑·Äô·Äü·ÄØ·Äê·Ä∫ Password ·Äô·Äæ·Ä¨·Ä∏·Äî·Ä±·Äï·Ä´·Äû·Ää·Ä∫·Åã');
            }
        });

        // REGISTER
        document.getElementById('registerFormElement').addEventListener('submit', function(e) {
            e.preventDefault();

            const username = document.getElementById('regUsername').value.trim();
            const email = document.getElementById('regEmail').value.trim();
            const password = document.getElementById('regPassword').value;
            const confirmPassword = document.getElementById('regConfirmPassword').value;
            const errorDiv = document.getElementById('registerError');
            const registerBtn = document.querySelector('#registerFormElement .auth-btn');

            if (!username || !email || !password || !confirmPassword) {
                showError(errorDiv, '·Ä°·ÄÅ·Äª·ÄÄ·Ä∫·Ä°·Äú·ÄÄ·Ä∫·Ä°·Ä¨·Ä∏·Äú·ÄØ·Ä∂·Ä∏ ·Äñ·Äº·Ää·Ä∑·Ä∫·Äõ·Äî·Ä∫·Äú·Ä≠·ÄØ·Ä°·Äï·Ä∫·Äï·Ä´·Äû·Ää·Ä∫·Åã');
                return;
            }

            if (username.length < 3) {
                showError(errorDiv, 'Username ·Äû·Ää·Ä∫ ·Ä°·Äî·Ää·Ä∫·Ä∏·ÄÜ·ÄØ·Ä∂·Ä∏ ·ÅÉ ·Äú·ÄØ·Ä∂·Ä∏·Äõ·Äæ·Ä≠·Äõ·Äï·Ä´·Äô·Ää·Ä∫·Åã');
                return;
            }

            if (password.length < 6) {
                showError(errorDiv, 'Password ·Äû·Ää·Ä∫ ·Ä°·Äî·Ää·Ä∫·Ä∏·ÄÜ·ÄØ·Ä∂·Ä∏ ·ÅÜ ·Äú·ÄØ·Ä∂·Ä∏·Äõ·Äæ·Ä≠·Äõ·Äï·Ä´·Äô·Ää·Ä∫·Åã');
                return;
            }

            if (password !== confirmPassword) {
                showError(errorDiv, 'Password ·Äî·Äæ·ÄÖ·Ä∫·ÄÅ·ÄØ ·Äô·Äê·Ä∞·Äï·Ä´·Åã');
                return;
            }

            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showError(errorDiv, '·ÄÄ·Äª·Ä±·Ä∏·Äá·Ä∞·Ä∏·Äï·Äº·ÄØ·Åç ·Äô·Äæ·Äî·Ä∫·ÄÄ·Äî·Ä∫·Äû·Ä±·Ä¨ email ·Äñ·Äº·Ää·Ä∑·Ä∫·Äï·Ä´·Åã');
                return;
            }

            const users = JSON.parse(localStorage.getItem(USERS_KEY) || '[]');

            if (users.some(u => u.username === username)) {
                showError(errorDiv, 'Username ·Ä°·Ä¨·Ä∏·Äû·ÄØ·Ä∂·Ä∏·Äï·Äº·ÄÆ·Ä∏·Äû·Ä¨·Ä∏·Äñ·Äº·ÄÖ·Ä∫·Äî·Ä±·Äï·Ä´·Äû·Ää·Ä∫·Åã');
                return;
            }

            if (users.some(u => u.email === email)) {
                showError(errorDiv, 'Email ·Ä°·Ä¨·Ä∏·Äû·ÄØ·Ä∂·Ä∏·Äï·Äº·ÄÆ·Ä∏·Äû·Ä¨·Ä∏·Äñ·Äº·ÄÖ·Ä∫·Äî·Ä±·Äï·Ä´·Äû·Ää·Ä∫·Åã');
                return;
            }

            const newUser = {
                id: Date.now().toString(),
                username: username,
                email: email,
                password: password,
                createdAt: new Date().toISOString()
            };

            users.push(newUser);
            localStorage.setItem(USERS_KEY, JSON.stringify(users));

            currentUser = {
                id: newUser.id,
                username: newUser.username,
                email: newUser.email
            };

            localStorage.setItem(CURRENT_USER_KEY, JSON.stringify(currentUser));
            const originalText = registerBtn.innerHTML;
            registerBtn.innerHTML = '<i class="fas fa-check"></i> Registration Successful!';
            registerBtn.style.background = 'var(--success)';

            setTimeout(() => {
                registerBtn.innerHTML = originalText;
                registerBtn.style.background = '';
                showMainApp();
            }, 900);
        });

        function showError(errorDiv, message) {
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
        }

        function logout() {
            if (confirm('·Äû·Ä±·ÄÅ·Äª·Ä¨·Äï·Ä±·Ä´·ÄÄ·Ä∫ Logout ·Äú·ÄØ·Äï·Ä∫·Äô·Äæ·Ä¨·Äú·Ä¨·Ä∏?')) {
                currentUser = null;
                localStorage.removeItem(CURRENT_USER_KEY);
                showAuthModal();
            }
        }

        /* ORDER FORM SYSTEM */
        let serviceOptions = {};

        function initializeServices() {
            // Load services from localStorage or use default
            const savedServices = localStorage.getItem(SERVICES_KEY);
            if (savedServices) {
                try {
                    serviceOptions = JSON.parse(savedServices);
                } catch (e) {
                    console.error("Error parsing services from local storage:", e);
                    // Fallback to default if parsing fails
                    setDefaultServices();
                }
            } else {
                // Default services
                setDefaultServices();
            }
            
            // Populate service select
            const serviceSelect = document.getElementById('service');
            const gameOptions = serviceSelect.querySelector('optgroup[label="üéÆ GAME TOP-UP"]');
            const socialOptions = serviceSelect.querySelector('optgroup[label="üì± SOCIAL MEDIA BOOST"]');
            
            // Clear existing options except the first one
            gameOptions.innerHTML = '';
            socialOptions.innerHTML = '';
            
            Object.keys(serviceOptions).forEach(serviceName => {
                const option = document.createElement('option');
                option.value = serviceName;
                option.textContent = serviceName;
                
                const serviceInfo = serviceOptions[serviceName];
                
                if (serviceInfo.category === 'game') {
                    gameOptions.appendChild(option);
                } else if (serviceInfo.category === 'social') {
                    socialOptions.appendChild(option);
                }
            });
        }

        function setDefaultServices() {
             serviceOptions = {
                "MLBB Diamond": {
                    category: 'game',
                    options: [
                        { text: "üíé 5 Diamonds (250 MMK)", value: "5 Diamonds (250 MMK)" },
                        { text: "üíé 12 Diamonds (600 MMK)", value: "12 Diamonds (600 MMK)" },
                        { text: "üíé 28 Diamonds (1,400 MMK)", value: "28 Diamonds (1,400 MMK)" },
                        { text: "üíé 56 Diamonds (2,500 MMK)", value: "56 Diamonds (2,500 MMK)" },
                        { text: "üíé 112 Diamonds (5,000 MMK)", value: "112 Diamonds (5,000 MMK)" },
                        { text: "üíé 225 Diamonds (10,000 MMK)", value: "225 Diamonds (10,000 MMK)" },
                        { text: "üíé 568 Diamonds (25,000 MMK)", value: "568 Diamonds (25,000 MMK)" }
                    ]
                },
                "PUBG UC": {
                    category: 'game',
                    options: [
                        { text: "üí∞ 60 UC (2,800 MMK)", value: "60 UC (2,800 MMK)" },
                        { text: "üí∞ 325 UC (13,500 MMK)", value: "325 UC (13,500 MMK)" },
                        { text: "üí∞ 660 UC (26,000 MMK)", value: "660 UC (26,000 MMK)" },
                        { text: "üí∞ 1,800 UC (70,000 MMK)", value: "1,800 UC (70,000 MMK)" }
                    ]
                },
                "TikTok Followers": {
                    category: 'social',
                    options: [
                        { text: "üë• 100 Followers (1,000 MMK)", value: "100 Followers (1,000 MMK)" },
                        { text: "üë• 500 Followers (4,500 MMK)", value: "500 Followers (4,500 MMK)" },
                        { text: "üë• 1000 Followers (8,000 MMK)", value: "1000 Followers (8,000 MMK)" }
                    ]
                }
            };
            localStorage.setItem(SERVICES_KEY, JSON.stringify(serviceOptions));
        }

        function initOrderForm() {
            const serviceSelect = document.getElementById('service');
            const amountSelect = document.getElementById('amount');
            const submitBtn = document.getElementById('submitBtn');
            const orderForm = document.getElementById('orderForm');

            serviceSelect.addEventListener('change', function() {
                const selectedService = this.value;
                updateFormFields(selectedService);
                updateAmountOptions(selectedService);
                submitBtn.disabled = true;
            });

            amountSelect.addEventListener('change', function() {
                submitBtn.disabled = !this.value;
            });

            orderForm.addEventListener('submit', function(e) {
                e.preventDefault();
                if (!currentUser) {
                    alert("·Äô·Äæ·Ä¨·Äö·Ä∞·Äõ·Äî·Ä∫ Login ·Äù·ÄÑ·Ä∫·Äõ·Äî·Ä∫·Äú·Ä≠·ÄØ·Ä°·Äï·Ä∫·Äï·Ä´·Äû·Ää·Ä∫·Åã");
                    showAuthModal();
                    return;
                }
                processOrder();
            });

            // Initial call if a service is already selected (e.g., after loading)
            updateFormFields(serviceSelect.value);
        }

        function updateFormFields(service) {
            const userIdLabel = document.getElementById('userIdLabel');
            const userIdInput = document.getElementById('userId');
            const zoneIdGroup = document.getElementById('zoneIdGroup');
            const serverGroup = document.getElementById('serverGroup');
            const serverLabel = document.getElementById('serverLabel');
            const serverSelect = document.getElementById('server');

            // Reset visibility and required state
            zoneIdGroup.style.display = 'none';
            document.getElementById('zoneId').required = false;
            serverGroup.style.display = 'none';
            serverSelect.required = false;

            let labelText = "Player ID / Username";
            let placeholderText = "·Äû·ÄÑ·Ä∑·Ä∫·Äõ·Ä≤·Ä∑ ID ·Äû·Ä≠·ÄØ·Ä∑·Äô·Äü·ÄØ·Äê·Ä∫ Username/Link ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´";
            let serverText = "Server/Region";

            switch(service) {
                case "MLBB Diamond":
                    labelText = "MLBB Player ID";
                    placeholderText = "·Äû·ÄÑ·Ä∑·Ä∫·Äõ·Ä≤·Ä∑ MLBB Player ID (·Ä•·Äï·Äô·Ä¨: 123456789)";
                    zoneIdGroup.style.display = 'block';
                    document.getElementById('zoneId').required = true;
                    break;

                case "PUBG UC":
                    labelText = "PUBG Player ID";
                    placeholderText = "·Äû·ÄÑ·Ä∑·Ä∫·Äõ·Ä≤·Ä∑ PUBG Player ID ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´";
                    serverGroup.style.display = 'block';
                    serverText = "PUBG Server (·Ä•·Äï·Äô·Ä¨: Asia)";
                    serverSelect.required = true;
                    break;

                case "Free Fire Diamond":
                    labelText = "Free Fire Player ID";
                    placeholderText = "·Äû·ÄÑ·Ä∑·Ä∫·Äõ·Ä≤·Ä∑ Free Fire Player ID ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´";
                    serverGroup.style.display = 'block';
                    serverText = "Free Fire Server";
                    serverSelect.required = true;
                    break;

                case "COD Points":
                    labelText = "COD Player ID";
                    placeholderText = "·Äû·ÄÑ·Ä∑·Ä∫·Äõ·Ä≤·Ä∑ COD Player ID ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´";
                    serverGroup.style.display = 'block';
                    serverText = "COD Server";
                    serverSelect.required = true;
                    break;

                case "Valorant Points":
                    labelText = "Valorant Username#Tag";
                    placeholderText = "·Äû·ÄÑ·Ä∑·Ä∫·Äõ·Ä≤·Ä∑ Valorant Username#Tag (·Ä•·Äï·Äô·Ä¨: Player#1234)";
                    serverGroup.style.display = 'block';
                    serverText = "Valorant Region";
                    serverSelect.required = true;
                    break;

                case "Genshin Impact Genesis":
                    labelText = "Genshin UID";
                    placeholderText = "·Äû·ÄÑ·Ä∑·Ä∫·Äõ·Ä≤·Ä∑ Genshin Impact UID ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´";
                    serverGroup.style.display = 'block';
                    serverText = "Genshin Server";
                    serverSelect.required = true;
                    break;

                case "TikTok Followers":
                case "TikTok Views":
                case "TikTok Likes":
                    labelText = "TikTok Link/Username";
                    placeholderText = "·Äû·ÄÑ·Ä∫·Åè TikTok Username ·Äû·Ä≠·ÄØ·Ä∑·Äô·Äü·ÄØ·Äê·Ä∫ Video URL ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´";
                    break;

                case "Instagram Followers":
                case "Instagram Likes":
                    labelText = "Instagram Link/Username";
                    placeholderText = "·Äû·ÄÑ·Ä∫·Åè Instagram Username ·Äû·Ä≠·ÄØ·Ä∑·Äô·Äü·ÄØ·Äê·Ä∫ Post URL ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´";
                    break;

                case "Facebook Page Likes":
                    labelText = "Facebook Page URL";
                    placeholderText = "·Äû·ÄÑ·Ä∫·Åè Facebook Page URL ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´";
                    break;

                case "YouTube Subscribers":
                    labelText = "YouTube Channel URL";
                    placeholderText = "·Äû·ÄÑ·Ä∫·Åè YouTube Channel URL ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´";
                    break;

                case "Telegram Members":
                    labelText = "Telegram Channel/Group URL";
                    placeholderText = "·Äû·ÄÑ·Ä∫·Åè Telegram Channel/Group URL ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´";
                    break;
            }

            userIdLabel.textContent = labelText;
            userIdInput.placeholder = placeholderText;
            serverLabel.textContent = serverText;

            // Clear values for hidden fields
            if (zoneIdGroup.style.display === 'none') document.getElementById('zoneId').value = '';
            if (serverGroup.style.display === 'none') document.getElementById('server').value = '';
        }

        function updateAmountOptions(service) {
            const amountSelect = document.getElementById('amount');
            amountSelect.innerHTML = '<option value="" disabled selected>·Äï·Äô·Ä¨·Äè ·Äõ·ÄΩ·Ä±·Ä∏·ÄÅ·Äª·Äö·Ä∫·Äï·Ä´</option>';

            const serviceData = serviceOptions[service];

            if (service && serviceData && serviceData.options) {
                serviceData.options.forEach(option => {
                    const opt = document.createElement('option');
                    opt.value = option.value;
                    opt.textContent = option.text;
                    amountSelect.appendChild(opt);
                });
                amountSelect.disabled = false;
            } else {
                amountSelect.disabled = true;
            }
        }

        function processOrder() {
            const service = document.getElementById('service').value;
            const userId = document.getElementById('userId').value.trim();
            const amount = document.getElementById('amount').value;
            const paymentId = document.getElementById('paymentId').value.trim();
            const remarks = document.getElementById('remarks').value.trim();
            const tgUsername = document.getElementById('tgUsername').value.trim();
            const zoneId = document.getElementById('zoneId').value.trim();
            const server = document.getElementById('server').value;

            const submitBtn = document.getElementById('submitBtn');
            const responseMessage = document.getElementById('responseMessage');

            if (!service || !userId || !amount || !paymentId) {
                showResponse('·ÄÄ·Äª·Ä±·Ä∏·Äá·Ä∞·Ä∏·Äï·Äº·ÄØ·Åç ·Äú·Ä≠·ÄØ·Ä°·Äï·Ä∫·Äû·Ä±·Ä¨·Ä°·ÄÅ·Äª·ÄÄ·Ä∫·Ä°·Äú·ÄÄ·Ä∫·Äô·Äª·Ä¨·Ä∏·Ä°·Ä¨·Ä∏·Äú·ÄØ·Ä∂·Ä∏ ·Äñ·Äº·Ää·Ä∑·Ä∫·ÄÖ·ÄΩ·ÄÄ·Ä∫·Äï·Ä´·Åã', 'error');
                return;
            }

            if (service === "MLBB Diamond" && !zoneId) {
                showResponse('MLBB ·Ä°·Äê·ÄΩ·ÄÄ·Ä∫ Zone ID ·Äë·Ää·Ä∑·Ä∫·Äû·ÄΩ·ÄÑ·Ä∫·Ä∏·Äõ·Äî·Ä∫·Äú·Ä≠·ÄØ·Ä°·Äï·Ä∫·Äï·Ä´·Äû·Ää·Ä∫·Åã', 'error');
                return;
            }

            const requiresServer = ["PUBG UC", "Free Fire Diamond", "COD Points", "Valorant Points", "Genshin Impact Genesis"];
             if (requiresServer.includes(service) && !server) {
                showResponse('Server/Region ·Äõ·ÄΩ·Ä±·Ä∏·ÄÅ·Äª·Äö·Ä∫·Äõ·Äî·Ä∫·Äú·Ä≠·ÄØ·Ä°·Äï·Ä∫·Äï·Ä´·Äû·Ää·Ä∫·Åã', 'error');
                return;
            }

            submitBtn.disabled = true;
            const originalBtnText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ·Äï·Ä≠·ÄØ·Ä∑·Äî·Ä±·Äï·Ä´·Äû·Ää·Ä∫...';

            // Save order
            const orderData = {
                id: Date.now().toString(),
                service: service,
                userId: userId,
                amount: amount,
                paymentId: paymentId,
                remarks: remarks,
                tgUsername: tgUsername,
                zoneId: zoneId,
                server: server,
                customer: {
                    username: currentUser.username,
                    email: currentUser.email
                },
                status: 'pending',
                timestamp: new Date().toISOString()
            };

            // Save to localStorage
            let orders = JSON.parse(localStorage.getItem(ORDERS_KEY) || '[]');
            orders.push(orderData);
            localStorage.setItem(ORDERS_KEY, JSON.stringify(orders));

            // Save to user's order history
            saveOrderToUserHistory(orderData);

            // --- Telegram Bot Integration (Mock/Demo only) ---
            // Note: In a real environment, this needs a secure backend to proxy the request.
            // Sending directly from JS may expose the BOT_TOKEN.

            const BOT_TOKEN = '8520010037:AAESl5q1q20BafTa1hhj7UXoAax5cg1Vu-I'; // Example Token
            const CHAT_ID = '8582088849'; // Example Chat ID
            const TELEGRAM_API_URL = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;

            let message = `*üÜï ·Äô·Äæ·Ä¨·Äö·Ä∞·Äô·Äæ·ÄØ·Ä°·Äû·ÄÖ·Ä∫ (Web UI) *\n`;
            message += `*·Äù·Äî·Ä∫·ÄÜ·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äæ·ÄØ:* ${service}\n`;
            message += `*Player ID:* ${userId}\n`;

            if (service === "MLBB Diamond") {
                message += `*Zone ID:* ${zoneId}\n`;
            }

            if (server) {
                message += `*Server:* ${server}\n`;
            }

            message += `*·Äï·Äô·Ä¨·Äè:* ${amount}\n`;
            message += `*·ÄÑ·ÄΩ·Ä±·Äú·ÄΩ·Äæ·Ä≤ ID:* ${paymentId}\n`;
            message += `*·ÄÑ·ÄΩ·Ä±·Äï·Ä±·Ä∏·ÄÅ·Äª·Ä±·Äô·Äæ·ÄØ:* KBZPay\n`; // Always Kpay now

            if (remarks) {
                message += `*·Äô·Äæ·Äê·Ä∫·ÄÅ·Äª·ÄÄ·Ä∫:* ${remarks}\n`;
            }

            if (tgUsername) {
                message += `*Telegram:* ${tgUsername}\n`;
            }

            message += `*·Äù·Äö·Ä∫·Äö·Ä∞·Äû·Ä∞:* ${currentUser.username} (${currentUser.email})\n`;
            message += `*·Ä°·ÄÅ·Äª·Ä≠·Äî·Ä∫:* ${new Date().toLocaleString('en-US', { hour12: true })}`;

            // Send to Telegram
            fetch(TELEGRAM_API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: new URLSearchParams({
                    chat_id: CHAT_ID,
                    text: message,
                    parse_mode: 'Markdown'
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.ok) {
                    showResponse(`‚úÖ ${service} ·Ä°·Äê·ÄΩ·ÄÄ·Ä∫ ·Äô·Äæ·Ä¨·Äö·Ä∞·Äô·Äæ·ÄØ ·Ä°·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äº·ÄÑ·Ä∫·Äï·Ä´·Äï·Äº·ÄÆ·Åã ·ÄÄ·Äª·Ä±·Ä∏·Äá·Ä∞·Ä∏·Äê·ÄÑ·Ä∫·Äï·Ä´·Äû·Ää·Ä∫·Åã`, 'success');
                    resetOrderForm();
                } else {
                    // Even if Telegram fails, the order is saved locally for admin to view
                    console.error('Telegram·Äï·Ä≠·ÄØ·Ä∑·Äõ·Ä¨·Äê·ÄΩ·ÄÑ·Ä∫ ·Ä°·Äô·Äæ·Ä¨·Ä∏·Äñ·Äº·ÄÖ·Ä∫·Äï·ÄΩ·Ä¨·Ä∏', data);
                    showResponse(`‚úÖ ·Äô·Äæ·Ä¨·Äö·Ä∞·Äô·Äæ·ÄØ ·Ä°·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äº·ÄÑ·Ä∫·Äï·Ä´·Äï·Äº·ÄÆ·Åã (Telegram Notification Error: Admin ·Äû·Ä≠·ÄØ·Ä∑·Äô·Äü·ÄØ·Äê·Ä∫ ·ÄÖ·Äî·ÄÖ·Ä∫·Äï·Äº·Äø·Äî·Ä¨) `, 'success');
                    resetOrderForm();
                }
            })
            .catch(error => {
                console.error('Error:', error);
                // Assume successful, but warn about communication error
                showResponse(`‚úÖ ·Äô·Äæ·Ä¨·Äö·Ä∞·Äô·Äæ·ÄØ ·Ä°·Ä±·Ä¨·ÄÑ·Ä∫·Äô·Äº·ÄÑ·Ä∫·Äï·Ä´·Äï·Äº·ÄÆ·Åã (Telegram Send Failed, but Order Saved Locally) `, 'success');
                resetOrderForm();
            })
            .finally(() => {
                setTimeout(() => {
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = originalBtnText;
                }, 1500);
            });
        }

        function showResponse(message, type) {
            const responseMessage = document.getElementById('responseMessage');
            responseMessage.textContent = message;
            responseMessage.className = `response-message ${type === 'success' ? 'response-success' : 'response-error'}`;
            responseMessage.style.display = 'block';

            setTimeout(() => {
                responseMessage.style.display = 'none';
            }, 5000);
        }

        function resetOrderForm() {
            document.getElementById('orderForm').reset();
            document.getElementById('amount').innerHTML = '<option value="" disabled selected>·Äï·Äô·Ä¨·Äè ·Äõ·ÄΩ·Ä±·Ä∏·ÄÅ·Äª·Äö·Ä∫·Äï·Ä´</option>';
            document.getElementById('amount').disabled = true;
            document.getElementById('submitBtn').disabled = true;

            document.getElementById('userIdLabel').textContent = 'Player ID / Username';
            document.getElementById('userId').placeholder = '·Äû·ÄÑ·Ä∑·Ä∫·Äõ·Ä≤·Ä∑ Player ID ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´';

            document.getElementById('zoneIdGroup').style.display = 'none';
            document.getElementById('serverGroup').style.display = 'none';
        }

        function saveOrderToUserHistory(orderData) {
            const users = JSON.parse(localStorage.getItem(USERS_KEY) || '[]');
            const userIndex = users.findIndex(u => u.id === currentUser.id);

            if (userIndex !== -1) {
                if (!users[userIndex].orders) {
                    users[userIndex].orders = [];
                }
                users[userIndex].orders.push({
                    service: orderData.service,
                    userId: orderData.userId,
                    amount: orderData.amount,
                    paymentId: orderData.paymentId,
                    timestamp: orderData.timestamp
                });
                localStorage.setItem(USERS_KEY, JSON.stringify(users));
            }
        }

        /* ADMIN PANEL FUNCTIONS */
        function showAdminLogin() {
            const username = prompt("Admin Username:");
            const password = prompt("Admin Password:");
            
            if (username === ADMIN_USERNAME && password === ADMIN_PASSWORD) {
                showAdminPanel();
            } else {
                alert("Invalid admin credentials!");
            }
        }

        function showAdminPanel() {
            document.getElementById('adminPanel').style.display = 'block';
            showAdminTab('users');
            loadUsers();
            loadServices();
            loadOrders();
        }

        function closeAdminPanel() {
            document.getElementById('adminPanel').style.display = 'none';
        }

        function showAdminTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.admin-tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(`admin${tabName.charAt(0).toUpperCase() + tabName.slice(1)}Tab`).classList.add('active');
            
            // Activate tab button
            document.querySelectorAll('.admin-tab').forEach(tab => {
                if (tab.textContent.toLowerCase().includes(tabName)) {
                    tab.classList.add('active');
                }
            });
            
            // Reload data on tab change
            if (tabName === 'users') loadUsers();
            if (tabName === 'services') loadServices();
            if (tabName === 'orders') loadOrders();
        }

        function loadUsers() {
            const users = JSON.parse(localStorage.getItem(USERS_KEY) || '[]');
            const userListDiv = document.getElementById('userList');
            
            userListDiv.innerHTML = '';
            
            if (users.length === 0) {
                userListDiv.innerHTML = '<div style="text-align:center;padding:20px;color:var(--muted);">No users found</div>';
                return;
            }
            
            users.forEach(user => {
                const userDiv = document.createElement('div');
                userDiv.className = 'user-item';
                userDiv.innerHTML = `
                    <div class="admin-user-info-bar">
                        <h4>${user.username}</h4>
                        <span class="user-meta" style="margin:0;">
                            <span><i class="fas fa-shopping-cart"></i> ${user.orders ? user.orders.length : 0} orders</span>
                        </span>
                    </div>
                    <div class="user-meta">
                        <span><i class="fas fa-envelope"></i> ${user.email}</span>
                        <span><i class="fas fa-calendar"></i> ${new Date(user.createdAt).toLocaleDateString()}</span>
                    </div>
                    <div class="user-actions">
                        <button onclick="editUser('${user.id}')" class="action-btn view">
                            <i class="fas fa-edit"></i> Edit User
                        </button>
                        <button onclick="viewUserOrders('${user.id}')" class="action-btn view">
                            <i class="fas fa-eye"></i> View Orders
                        </button>
                        <button onclick="deleteUser('${user.id}')" class="action-btn delete">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                `;
                userListDiv.appendChild(userDiv);
            });
        }

        function searchUsers() {
            const searchTerm = document.getElementById('userSearch').value.toLowerCase();
            const users = JSON.parse(localStorage.getItem(USERS_KEY) || '[]');
            const userListDiv = document.getElementById('userList');
            
            userListDiv.innerHTML = '';
            
            const filteredUsers = users.filter(user => 
                user.username.toLowerCase().includes(searchTerm) || 
                user.email.toLowerCase().includes(searchTerm)
            );
            
            if (filteredUsers.length === 0) {
                userListDiv.innerHTML = '<div style="text-align:center;padding:20px;color:var(--muted);">No users found</div>';
                return;
            }
            
            filteredUsers.forEach(user => {
                 const userDiv = document.createElement('div');
                userDiv.className = 'user-item';
                userDiv.innerHTML = `
                    <div class="admin-user-info-bar">
                        <h4>${user.username}</h4>
                        <span class="user-meta" style="margin:0;">
                            <span><i class="fas fa-shopping-cart"></i> ${user.orders ? user.orders.length : 0} orders</span>
                        </span>
                    </div>
                    <div class="user-meta">
                        <span><i class="fas fa-envelope"></i> ${user.email}</span>
                        <span><i class="fas fa-calendar"></i> ${new Date(user.createdAt).toLocaleDateString()}</span>
                    </div>
                    <div class="user-actions">
                        <button onclick="editUser('${user.id}')" class="action-btn view">
                            <i class="fas fa-edit"></i> Edit User
                        </button>
                        <button onclick="viewUserOrders('${user.id}')" class="action-btn view">
                            <i class="fas fa-eye"></i> View Orders
                        </button>
                        <button onclick="deleteUser('${user.id}')" class="action-btn delete">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                `;
                userListDiv.appendChild(userDiv);
            });
        }

        function deleteUser(userId) {
            if (!confirm('Are you sure you want to delete this user?')) return;
            
            let users = JSON.parse(localStorage.getItem(USERS_KEY) || '[]');
            users = users.filter(user => user.id !== userId);
            localStorage.setItem(USERS_KEY, JSON.stringify(users));
            
            // If current user is deleted, logout
            if (currentUser && currentUser.id === userId) {
                logout();
            }
            
            loadUsers();
            alert('User deleted successfully!');
        }

        // 1. EDIT USER FUNCTIONALITY
        function editUser(userId) {
            let users = JSON.parse(localStorage.getItem(USERS_KEY) || '[]');
            const user = users.find(u => u.id === userId);

            if (!user) {
                alert('User not found.');
                return;
            }

            const modalContent = `
                <div class="form-group">
                    <label class="form-label">Username</label>
                    <input type="text" id="editUsername" class="form-input" value="${user.username}" placeholder="Username" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" id="editEmail" class="form-input" value="${user.email}" placeholder="Email" required>
                </div>
                <div class="form-group">
                    <label class="form-label">New Password (Optional)</label>
                    <input type="text" id="editPassword" class="form-input" placeholder="New Password (Leave blank to keep current)">
                </div>
            `;

            alertModal('Edit User: ' + user.username, modalContent, () => {
                const newUsername = document.getElementById('editUsername').value.trim();
                const newEmail = document.getElementById('editEmail').value.trim();
                const newPassword = document.getElementById('editPassword').value;

                if (!newUsername || !newEmail) {
                    alert('Username and Email cannot be empty.');
                    return;
                }

                // Update user data
                user.username = newUsername;
                user.email = newEmail;
                if (newPassword) {
                    user.password = newPassword; 
                }

                localStorage.setItem(USERS_KEY, JSON.stringify(users));
                loadUsers();
                document.querySelector('.admin-modal-container').remove();
                alert('User updated successfully!');
            });
        }
        
        // Modal for viewing user orders (re-uses alertModal structure)
        function viewUserOrders(userId) {
            const users = JSON.parse(localStorage.getItem(USERS_KEY) || '[]');
            const user = users.find(u => u.id === userId);
            
            if (!user || !user.orders || user.orders.length === 0) {
                alert('This user has no orders.');
                return;
            }
            
            let ordersHtml = `<h4 style="margin-bottom:15px;color:var(--primary);">Orders History for ${user.username}</h4>`;
            ordersHtml += '<div style="max-height: 400px; overflow-y: auto;">';
            user.orders.forEach(order => {
                ordersHtml += `
                    <div class="order-item" style="margin-bottom:10px;">
                        <div class="order-header">
                            <span class="order-service">${order.service}</span>
                            <span class="order-time">${new Date(order.timestamp).toLocaleString()}</span>
                        </div>
                        <div class="order-details">
                            <div class="order-detail-item">
                                <div class="order-detail-label">Player ID</div>
                                <div class="order-detail-value">${order.userId}</div>
                            </div>
                            <div class="order-detail-item">
                                <div class="order-detail-label">Amount</div>
                                <div class="order-detail-value">${order.amount}</div>
                            </div>
                        </div>
                    </div>
                `;
            });
            ordersHtml += '</div>';
            
            alertModal('User Orders', ordersHtml, () => document.querySelector('.admin-modal-container').remove(), true); // true to hide save button
        }

        function loadServices() {
            const services = serviceOptions;
            const serviceListDiv = document.getElementById('serviceList');
            
            serviceListDiv.innerHTML = '';
            
            if (Object.keys(services).length === 0) {
                serviceListDiv.innerHTML = '<div style="text-align:center;padding:20px;color:var(--muted);">No services found. Click "Add New Service" to start.</div>';
                return;
            }
            
            Object.keys(services).forEach(serviceName => {
                const serviceDiv = document.createElement('div');
                serviceDiv.className = 'service-item';
                
                const serviceData = services[serviceName];
                const categoryText = serviceData.category === 'game' ? 'Game Top-up' : 'Social Media Boost';
                
                serviceDiv.innerHTML = `
                    <div class="service-header">
                        <h4 class="service-name">${serviceName}</h4>
                        <span class="service-category">${categoryText}</span>
                    </div>
                    <div class="service-options">
                        ${serviceData.options.map(option => 
                            `<div class="option-item">${option.text}</div>`
                        ).join('')}
                    </div>
                    <div class="user-actions" style="margin-top:10px;">
                        <button onclick="editService('${serviceName}')" class="action-btn view">
                            <i class="fas fa-edit"></i> Edit Service
                        </button>
                        <button onclick="deleteService('${serviceName}')" class="action-btn delete">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                `;
                serviceListDiv.appendChild(serviceDiv);
            });
        }

        function showAddServiceModal() {
            document.getElementById('addServiceModal').style.display = 'flex';
            document.getElementById('newServiceName').value = '';
            document.getElementById('newServiceOptions').value = '';
            document.getElementById('newServiceCategory').value = 'game';
        }

        function closeAddServiceModal() {
            document.getElementById('addServiceModal').style.display = 'none';
        }

        function saveNewService() {
            const name = document.getElementById('newServiceName').value.trim();
            const category = document.getElementById('newServiceCategory').value;
            const optionsText = document.getElementById('newServiceOptions').value.trim();
            
            if (!name || !optionsText) {
                alert('Please fill all fields');
                return;
            }
            
            if (serviceOptions[name]) {
                alert('Service Name already exists!');
                return;
            }

            try {
                const options = JSON.parse(optionsText);
                if (!Array.isArray(options) || options.some(opt => typeof opt.text !== 'string' || typeof opt.value !== 'string')) {
                    throw new Error("Options must be an array of {text: string, value: string} objects.");
                }

                // Add new service
                serviceOptions[name] = {
                    category: category,
                    options: options
                };
                localStorage.setItem(SERVICES_KEY, JSON.stringify(serviceOptions));
                
                // Update UI
                initializeServices();
                loadServices();
                
                // Close modal
                closeAddServiceModal();
                alert('Service added successfully!');
            } catch (e) {
                alert('Invalid options format: ' + e.message);
            }
        }
        
        // 2. EDIT SERVICE FUNCTIONALITY
        function editService(serviceName) {
            const serviceData = serviceOptions[serviceName];
            if (!serviceData) {
                alert('Service not found.');
                return;
            }

            const optionsJson = JSON.stringify(serviceData.options, null, 2);

            const modalContent = `
                <div class="form-group">
                    <label class="form-label">Service Name</label>
                    <input type="text" id="editServiceName" class="form-input" value="${serviceName}" placeholder="e.g., MLBB Diamond" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Service Category</label>
                    <select id="editServiceCategory" class="form-select">
                        <option value="game" ${serviceData.category === 'game' ? 'selected' : ''}>Game Top-up</option>
                        <option value="social" ${serviceData.category === 'social' ? 'selected' : ''}>Social Media Boost</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Options (JSON Format)</label>
                    <textarea id="editServiceOptions" class="form-input" rows="8" required>${optionsJson}</textarea>
                    <small style="color:var(--muted);">Enter options in JSON array format</small>
                </div>
            `;

            alertModal('Edit Service: ' + serviceName, modalContent, () => {
                const newName = document.getElementById('editServiceName').value.trim();
                const newCategory = document.getElementById('editServiceCategory').value;
                const newOptionsText = document.getElementById('editServiceOptions').value.trim();

                if (!newName || !newOptionsText) {
                    alert('All fields are required.');
                    return;
                }
                
                if (newName !== serviceName && serviceOptions[newName]) {
                     alert('New Service Name already exists!');
                     return;
                }

                try {
                    const newOptions = JSON.parse(newOptionsText);
                    if (!Array.isArray(newOptions) || newOptions.some(opt => typeof opt.text !== 'string' || typeof opt.value !== 'string')) {
                         throw new Error("Options must be an array of {text: string, value: string} objects.");
                    }

                    if (newName !== serviceName) {
                        // Rename service
                        serviceOptions[newName] = { category: newCategory, options: newOptions };
                        delete serviceOptions[serviceName];
                    } else {
                        // Update options and category
                        serviceOptions[newName] = { category: newCategory, options: newOptions };
                    }

                    localStorage.setItem(SERVICES_KEY, JSON.stringify(serviceOptions));

                    // Update UI
                    initializeServices();
                    loadServices();
                    
                    document.querySelector('.admin-modal-container').remove();
                    alert('Service updated successfully!');

                } catch (e) {
                    alert('Invalid options format: ' + e.message);
                }
            });
        }


        function deleteService(serviceName) {
            if (!confirm(`Are you sure you want to delete ${serviceName}?`)) return;
            
            delete serviceOptions[serviceName];
            localStorage.setItem(SERVICES_KEY, JSON.stringify(serviceOptions));
            initializeServices();
            loadServices();
            alert('Service deleted successfully!');
        }

        function loadOrders() {
            let orders = JSON.parse(localStorage.getItem(ORDERS_KEY) || '[]');
            
            // Sort by date (newest first)
            orders.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            
            displayFilteredOrders(orders); // Use the existing function to display
        }

        function filterOrders() {
            const filter = document.getElementById('orderFilter').value;
            let orders = JSON.parse(localStorage.getItem(ORDERS_KEY) || '[]');
            
            // Sort by date (newest first)
            orders.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            
            if (filter === 'today') {
                const today = new Date().toDateString();
                orders = orders.filter(order => new Date(order.timestamp).toDateString() === today);
            } else if (filter === 'week') {
                const oneWeekAgo = new Date();
                oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
                orders = orders.filter(order => new Date(order.timestamp) >= oneWeekAgo);
            } else if (filter === 'month') {
                const oneMonthAgo = new Date();
                oneMonthAgo.setMonth(oneMonthAgo.getMonth() - 1);
                orders = orders.filter(order => new Date(order.timestamp) >= oneMonthAgo);
            }
            
            displayFilteredOrders(orders);
        }

        function displayFilteredOrders(orders) {
            const orderListDiv = document.getElementById('orderList');
            
            orderListDiv.innerHTML = '';
            
            if (orders.length === 0) {
                orderListDiv.innerHTML = '<div style="text-align:center;padding:20px;color:var(--muted);">No orders found</div>';
                return;
            }
            
            orders.forEach(order => {
                const orderDiv = document.createElement('div');
                orderDiv.className = 'order-item';
                
                let statusColor = 'var(--primary)';
                if (order.status === 'completed') statusColor = 'var(--success)';
                if (order.status === 'cancelled') statusColor = 'var(--danger)';
                
                orderDiv.innerHTML = `
                    <div class="order-header">
                        <span class="order-service">${order.service}</span>
                        <span class="order-time">${new Date(order.timestamp).toLocaleString()}</span>
                    </div>
                    <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;flex-wrap: wrap;">
                        <span style="background:${statusColor};color:white;padding:3px 8px;border-radius:4px;font-size:12px;">
                            ${order.status || 'pending'}
                        </span>
                        <span style="color:var(--muted);font-size:12px;">
                            <i class="fas fa-user"></i> ${order.customer?.username || 'N/A'}
                        </span>
                        <span style="color:var(--muted);font-size:12px;">
                            <i class="fas fa-money-bill-wave"></i> KBZPay
                        </span>
                    </div>
                    <div class="order-details">
                        <div class="order-detail-item">
                            <div class="order-detail-label">Player ID/Link</div>
                            <div class="order-detail-value">${order.userId}</div>
                        </div>
                        ${order.zoneId ? `
                        <div class="order-detail-item">
                            <div class="order-detail-label">Zone ID</div>
                            <div class="order-detail-value">${order.zoneId}</div>
                        </div>
                        ` : ''}
                         ${order.server ? `
                        <div class="order-detail-item">
                            <div class="order-detail-label">Server</div>
                            <div class="order-detail-value">${order.server}</div>
                        </div>
                        ` : ''}
                        <div class="order-detail-item">
                            <div class="order-detail-label">Amount/Price</div>
                            <div class="order-detail-value">${order.amount}</div>
                        </div>
                        <div class="order-detail-item">
                            <div class="order-detail-label">Payment ID</div>
                            <div class="order-detail-value">${order.paymentId}</div>
                        </div>
                    </div>
                    <div class="user-actions" style="margin-top:10px;">
                         <button onclick="viewOrderDetails('${order.id}')" class="action-btn view">
                            <i class="fas fa-edit"></i> View/Edit
                        </button>
                        <button onclick="updateOrderStatus('${order.id}', 'completed')" class="action-btn" style="background:var(--success);color:white;border:none;">
                            <i class="fas fa-check"></i> Complete
                        </button>
                        <button onclick="updateOrderStatus('${order.id}', 'cancelled')" class="action-btn" style="background:var(--danger);color:white;border:none;">
                            <i class="fas fa-times"></i> Cancel
                        </button>
                        <button onclick="deleteOrder('${order.id}')" class="action-btn delete">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                `;
                orderListDiv.appendChild(orderDiv);
            });
        }

        function updateOrderStatus(orderId, status) {
            let orders = JSON.parse(localStorage.getItem(ORDERS_KEY) || '[]');
            const orderIndex = orders.findIndex(o => o.id === orderId);
            
            if (orderIndex !== -1) {
                orders[orderIndex].status = status;
                localStorage.setItem(ORDERS_KEY, JSON.stringify(orders));
                loadOrders();
                alert(`Order ID: ${orderId} updated to ${status} successfully!`);
            }
        }

        function deleteOrder(orderId) {
            if (!confirm('Are you sure you want to delete this order?')) return;
            
            let orders = JSON.parse(localStorage.getItem(ORDERS_KEY) || '[]');
            orders = orders.filter(o => o.id !== orderId);
            localStorage.setItem(ORDERS_KEY, JSON.stringify(orders));
            loadOrders();
            alert('Order deleted successfully!');
        }

        // 3. EDIT ORDER DETAILS FUNCTIONALITY
        function viewOrderDetails(orderId) {
            let orders = JSON.parse(localStorage.getItem(ORDERS_KEY) || '[]');
            const order = orders.find(o => o.id === orderId);

            if (!order) {
                alert('Order not found.');
                return;
            }

            const modalContent = `
                <div class="form-group">
                    <label class="form-label">Order ID</label>
                    <input type="text" class="form-input" value="${order.id}" readonly>
                </div>
                <div class="form-group">
                    <label class="form-label">Service</label>
                    <input type="text" class="form-input" value="${order.service}" readonly>
                </div>
                <div class="form-group">
                    <label class="form-label">Player ID/Link</label>
                    <input type="text" id="editOrderUserId" class="form-input" value="${order.userId}" required>
                </div>
                ${order.zoneId ? `
                <div class="form-group">
                    <label class="form-label">Zone ID</label>
                    <input type="text" id="editOrderZoneId" class="form-input" value="${order.zoneId}" required>
                </div>
                ` : ''}
                ${order.server ? `
                <div class="form-group">
                    <label class="form-label">Server</label>
                    <input type="text" id="editOrderServer" class="form-input" value="${order.server}" required>
                </div>
                ` : ''}
                <div class="form-group">
                    <label class="form-label">Amount</label>
                    <input type="text" id="editOrderAmount" class="form-input" value="${order.amount}" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Payment ID (Transfer ID)</label>
                    <input type="text" id="editOrderPaymentId" class="form-input" value="${order.paymentId}" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Telegram Username</label>
                    <input type="text" id="editOrderTgUsername" class="form-input" value="${order.tgUsername || ''}">
                </div>
                <div class="form-group">
                    <label class="form-label">Remarks</label>
                    <input type="text" id="editOrderRemarks" class="form-input" value="${order.remarks || ''}">
                </div>
                <div class="form-group">
                    <label class="form-label">Status</label>
                    <select id="editOrderStatus" class="form-select">
                        <option value="pending" ${order.status === 'pending' ? 'selected' : ''}>Pending</option>
                        <option value="completed" ${order.status === 'completed' ? 'selected' : ''}>Completed</option>
                        <option value="cancelled" ${order.status === 'cancelled' ? 'selected' : ''}>Cancelled</option>
                    </select>
                </div>
            `;

            alertModal(`Edit Order: #${order.id}`, modalContent, () => {
                const orders = JSON.parse(localStorage.getItem(ORDERS_KEY) || '[]');
                const orderIndex = orders.findIndex(o => o.id === orderId);
                
                if (orderIndex !== -1) {
                    orders[orderIndex].userId = document.getElementById('editOrderUserId').value.trim();
                    orders[orderIndex].amount = document.getElementById('editOrderAmount').value.trim();
                    orders[orderIndex].paymentId = document.getElementById('editOrderPaymentId').value.trim();
                    orders[orderIndex].tgUsername = document.getElementById('editOrderTgUsername').value.trim();
                    orders[orderIndex].remarks = document.getElementById('editOrderRemarks').value.trim();
                    orders[orderIndex].status = document.getElementById('editOrderStatus').value;

                    if (order.zoneId) {
                        orders[orderIndex].zoneId = document.getElementById('editOrderZoneId').value.trim();
                    }
                    if (order.server) {
                        orders[orderIndex].server = document.getElementById('editOrderServer').value.trim();
                    }

                    localStorage.setItem(ORDERS_KEY, JSON.stringify(orders));
                    loadOrders();
                    document.querySelector('.admin-modal-container').remove();
                    alert('Order updated successfully!');
                }
            });
        }


        // Universal Modal Creator for Admin Editing/Viewing
        function alertModal(title, content, onSave, hideCancel = false) {
            const existingModal = document.querySelector('.admin-modal-container');
            if (existingModal) existingModal.remove();

            const modal = document.createElement('div');
            modal.className = 'admin-modal-container'; 
            
            // Modal HTML Structure
            modal.innerHTML = `
                <div class="admin-modal-content" style="max-width:550px;">
                    <div class="admin-modal-header">
                        <h3 style="margin:0;color:var(--accent);">${title}</h3>
                        <button class="admin-modal-close" onclick="this.parentElement.parentElement.parentElement.remove()" style="background:transparent;border:none;color:var(--muted);cursor:pointer;">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="admin-modal-body">
                        ${content}
                    </div>
                    <div class="admin-modal-footer">
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" class="admin-cancel-btn" style="${hideCancel ? 'display:none;' : ''}">Cancel</button>
                        <button id="alertModalSaveBtn" class="admin-save-btn" style="${hideCancel ? 'display:none;' : ''}">Save Changes</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);

            // Attach Save handler
            if (document.getElementById('alertModalSaveBtn')) {
                document.getElementById('alertModalSaveBtn').onclick = function() {
                    onSave();
                };
            }
        }
    </script>
</body>
</html>

